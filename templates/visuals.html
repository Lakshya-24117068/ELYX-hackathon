<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Health Data Visuals</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
  <style>
    body { margin:0; font-family: Arial, sans-serif; background:#f0f2f5; color:#333; }
    h1 { text-align:center; padding:20px; color:#1b4b7a; }

    .accordion {
      width:90%; max-width:1400px; margin:20px auto;
      border-radius:10px; overflow:hidden; background:#fff;
      box-shadow:0 4px 12px rgba(0,0,0,0.1);
    }
    .accordion-header {
      background:#1b4b7a; color:#fff; padding:15px 20px;
      cursor:pointer; font-size:18px; font-weight:bold;
      display:flex; justify-content:space-between; align-items:center;
    }
    .accordion-header:hover { background:#163a5d; }
    .accordion-content {
      display:none; padding:20px; border-top:1px solid #ddd;
    }
    .controls {
      display:flex; justify-content:center; align-items:center;
      gap:20px; margin-bottom:10px;
    }
    select, input[type="month"] {
      padding:8px; border:1px solid #ccc; border-radius:5px;
      font-size:15px; cursor:pointer;
    }
    canvas { width:100% !important; height:70vh !important; }
    .rotate { transform:rotate(90deg); transition:transform 0.3s; }
    .rotate.active { transform:rotate(-90deg); }
  </style>
</head>
<body>
  <h1>Patient Health Trends</h1>

  <!-- Blood Pressure -->
  <div class="accordion">
    <div class="accordion-header">Blood Pressure <span class="rotate">▶</span></div>
    <div class="accordion-content">
      <div class="controls">
        <label>Select Range:</label>
        <select id="bpRangeSelect">
          <option value="all">All Data</option>
          <option value="month">Last 30 days</option>
          <option value="week">Last 7 days</option>
          <option value="custom">Custom Month</option>
        </select>
        <input type="month" id="bpMonthPicker" style="display:none;">
      </div>
      <canvas id="bpChart"></canvas>
    </div>
  </div>

  <!-- Sleep -->
  <div class="accordion">
    <div class="accordion-header">Sleep Duration <span class="rotate">▶</span></div>
    <div class="accordion-content">
      <div class="controls">
        <label>Select Range:</label>
        <select id="sleepRangeSelect">
          <option value="all">All Data</option>
          <option value="month">Last 30 days</option>
          <option value="week">Last 7 days</option>
          <option value="custom">Custom Month</option>
        </select>
        <input type="month" id="sleepMonthPicker" style="display:none;">
      </div>
      <canvas id="sleepChart"></canvas>
    </div>
  </div>

  <!-- Heart Rate -->
  <div class="accordion">
    <div class="accordion-header">Heart Rate <span class="rotate">▶</span></div>
    <div class="accordion-content">
      <div class="controls">
        <label>Select Range:</label>
        <select id="hrRangeSelect">
          <option value="all">All Data</option>
          <option value="month">Last 30 days</option>
          <option value="week">Last 7 days</option>
          <option value="custom">Custom Month</option>
        </select>
        <input type="month" id="hrMonthPicker" style="display:none;">
      </div>
      <canvas id="hrChart"></canvas>
    </div>
  </div>

  <!-- Oxygen -->
  <div class="accordion">
    <div class="accordion-header">Oxygen Level <span class="rotate">▶</span></div>
    <div class="accordion-content">
      <div class="controls">
        <label>Select Range:</label>
        <select id="oxyRangeSelect">
          <option value="all">All Data</option>
          <option value="month">Last 30 days</option>
          <option value="week">Last 7 days</option>
          <option value="custom">Custom Month</option>
        </select>
        <input type="month" id="oxyMonthPicker" style="display:none;">
      </div>
      <canvas id="oxyChart"></canvas>
    </div>
  </div>

  <!-- Steps -->
  <div class="accordion">
    <div class="accordion-header">Steps Walked <span class="rotate">▶</span></div>
    <div class="accordion-content">
      <div class="controls">
        <label>Select Range:</label>
        <select id="stepsRangeSelect">
          <option value="all">All Data</option>
          <option value="month">Last 30 days</option>
          <option value="week">Last 7 days</option>
          <option value="custom">Custom Month</option>
        </select>
        <input type="month" id="stepsMonthPicker" style="display:none;">
      </div>
      <canvas id="stepsChart"></canvas>
    </div>
  </div>

  <!-- Temperature -->
  <div class="accordion">
    <div class="accordion-header">Body Temperature <span class="rotate">▶</span></div>
    <div class="accordion-content">
      <div class="controls">
        <label>Select Range:</label>
        <select id="tempRangeSelect">
          <option value="all">All Data</option>
          <option value="month">Last 30 days</option>
          <option value="week">Last 7 days</option>
          <option value="custom">Custom Month</option>
        </select>
        <input type="month" id="tempMonthPicker" style="display:none;">
      </div>
      <canvas id="tempChart"></canvas>
    </div>
  </div>

  <script>
    // Accordion logic
    document.querySelectorAll(".accordion-header").forEach(header=>{
      header.addEventListener("click", ()=>{
        const content = header.nextElementSibling;
        const arrow = header.querySelector(".rotate");
        content.style.display = content.style.display==="block" ? "none":"block";
        arrow.classList.toggle("active");
      });
    });

    // ---- Data Generator ----
    function generateData(metric) {
      const data = [];
      const now = new Date();
      for (let i = 0; i < 100; i++) {
        const d = new Date(now);
        d.setDate(d.getDate() - (100 - i));
        let value;
        switch(metric) {
          case "bp": value = 110 + Math.floor(Math.random() * 30); break;
          case "sleep": value = 5 + Math.random() * 4; break;
          case "hr": value = 60 + Math.floor(Math.random() * 40); break;
          case "oxy": value = 92 + Math.random() * 8; break;
          case "steps": value = 3000 + Math.floor(Math.random() * 7000); break;
          case "temp": value = 36 + Math.random() * 2; break;
        }
        data.push({ x:d, y:value });
      }
      return data;
    }

    // ---- Chart Creator ----
    function createChart(ctx, label, data, color) {
      return new Chart(ctx, {
        type: "line",
        data: { datasets: [{ label, data, borderColor: color, tension:0.3, pointRadius:0 }] },
        options: {
          responsive:true, maintainAspectRatio:false,
          interaction:{ mode:"index", intersect:false },
          scales:{ x:{ type:"time", time:{ unit:"day" } } },
          plugins:{ zoom:{ zoom:{ wheel:{ enabled:true }, pinch:{ enabled:true }, mode:"x" }, pan:{ enabled:true, mode:"x" } } }
        }
      });
    }

    // ---- Filtering ----
    function filterData(data, range, customMonth) {
      const now = new Date();
      let start;
      if(range==="month") start = new Date(now.setDate(now.getDate()-30));
      else if(range==="week") start = new Date(now.setDate(now.getDate()-7));
      else if(range==="custom" && customMonth){
        const [year,month] = customMonth.split("-");
        start = new Date(year, month-1, 1);
        const end = new Date(year, month, 0);
        return data.filter(d=> d.x>=start && d.x<=end);
      }
      return range==="all" ? data : data.filter(d=>d.x>=start);
    }

    // ---- Initialize Charts ----
    const bpData = generateData("bp");
    const sleepData = generateData("sleep");
    const hrData = generateData("hr");
    const oxyData = generateData("oxy");
    const stepsData = generateData("steps");
    const tempData = generateData("temp");

    const bpChart = createChart(document.getElementById("bpChart"), "Blood Pressure", bpData, "red");
    const sleepChart = createChart(document.getElementById("sleepChart"), "Sleep Hours", sleepData, "blue");
    const hrChart = createChart(document.getElementById("hrChart"), "Heart Rate", hrData, "green");
    const oxyChart = createChart(document.getElementById("oxyChart"), "Oxygen %", oxyData, "purple");
    const stepsChart = createChart(document.getElementById("stepsChart"), "Steps", stepsData, "orange");
    const tempChart = createChart(document.getElementById("tempChart"), "Temperature", tempData, "brown");

    // ---- Controls ----
    function attachControls(selectId, monthId, chart, originalData){
      const select = document.getElementById(selectId);
      const monthPicker = document.getElementById(monthId);
      select.addEventListener("change", ()=>{
        if(select.value==="custom") monthPicker.style.display="inline-block";
        else monthPicker.style.display="none";
        chart.data.datasets[0].data = filterData(originalData, select.value, monthPicker.value);
        chart.update();
      });
      monthPicker.addEventListener("change", ()=>{
        chart.data.datasets[0].data = filterData(originalData, select.value, monthPicker.value);
        chart.update();
      });
    }
    attachControls("bpRangeSelect", "bpMonthPicker", bpChart, bpData);
    attachControls("sleepRangeSelect", "sleepMonthPicker", sleepChart, sleepData);
    attachControls("hrRangeSelect", "hrMonthPicker", hrChart, hrData);
    attachControls("oxyRangeSelect", "oxyMonthPicker", oxyChart, oxyData);
    attachControls("stepsRangeSelect", "stepsMonthPicker", stepsChart, stepsData);
    attachControls("tempRangeSelect", "tempMonthPicker", tempChart, tempData);
  </script>
</body>
</html>
